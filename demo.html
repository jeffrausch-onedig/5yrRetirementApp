<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>5-Year Retirement Plan Evaluation - Interactive Demo</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .demo-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .demo-section {
            background: white;
            border-radius: 10px;
            padding: 30px;
            margin: 20px 0;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .quick-inputs {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .quick-input-group {
            display: flex;
            flex-direction: column;
        }
        
        .quick-input-group label {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 8px;
        }
        
        .quick-input-group input,
        .quick-input-group select {
            padding: 10px;
            border: 2px solid #e9ecef;
            border-radius: 6px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }
        
        .quick-input-group input:focus,
        .quick-input-group select:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .impact-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .impact-card {
            background: linear-gradient(135deg, #f8f9ff 0%, #e8f0ff 100%);
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            border-left: 4px solid #667eea;
            transition: transform 0.3s ease;
        }
        
        .impact-card:hover {
            transform: translateY(-2px);
        }
        
        .impact-value {
            font-size: 2rem;
            font-weight: bold;
            color: #667eea;
            margin: 10px 0;
        }
        
        .impact-label {
            font-size: 0.9rem;
            color: #6c757d;
            font-weight: 500;
        }
        
        .impact-change {
            font-size: 0.8rem;
            font-weight: 600;
            margin-top: 5px;
            padding: 4px 8px;
            border-radius: 12px;
        }
        
        .impact-change.positive {
            background: rgba(39, 174, 96, 0.1);
            color: #27ae60;
        }
        
        .impact-change.negative {
            background: rgba(231, 76, 60, 0.1);
            color: #e74c3c;
        }
        
        .scenario-toggle {
            display: flex;
            gap: 10px;
            margin: 20px 0;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .scenario-btn {
            padding: 10px 20px;
            border: 2px solid #667eea;
            background: white;
            color: #667eea;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .scenario-btn.active {
            background: #667eea;
            color: white;
        }
        
        .scenario-btn:hover {
            background: #667eea;
            color: white;
        }
        
        .demo-chart {
            height: 400px;
            margin: 30px 0;
        }
        
        .calculation-notes {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            font-size: 0.9rem;
            color: #6c757d;
        }
        
        .presets {
            display: flex;
            gap: 10px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .preset-btn {
            padding: 8px 16px;
            background: #e9ecef;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: background 0.3s ease;
        }
        
        .preset-btn:hover {
            background: #dee2e6;
        }
        
        @media (max-width: 768px) {
            .quick-inputs {
                grid-template-columns: 1fr;
            }
            
            .scenario-toggle {
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
</head>
<body>
    <div class="demo-container">
        <header>
            <h1>Interactive Engagement Demo</h1>
            <p class="subtitle">Quick Scenario Modeling for Client Presentations</p>
        </header>

        <!-- Quick Input Controls -->
        <div class="demo-section">
            <h2>Plan Parameters</h2>
            
            <div class="presets">
                <button class="preset-btn" onclick="loadPreset('small')">Small Plan (100 employees)</button>
                <button class="preset-btn" onclick="loadPreset('medium')">Medium Plan (500 employees)</button>
                <button class="preset-btn" onclick="loadPreset('large')">Large Plan (2000 employees)</button>
            </div>
            
            <div class="quick-inputs">
                <div class="quick-input-group">
                    <label for="demoEmployees">Eligible Employees</label>
                    <input type="number" id="demoEmployees" value="500" oninput="updateDemo()">
                </div>
                <div class="quick-input-group">
                    <label for="demoParticipation">Current Participation (%)</label>
                    <input type="number" id="demoParticipation" value="65" min="0" max="100" oninput="updateDemo()">
                </div>
                <div class="quick-input-group">
                    <label for="demoSalary">Average Salary ($)</label>
                    <input type="number" id="demoSalary" value="75000" oninput="updateDemo()">
                </div>
                <div class="quick-input-group">
                    <label for="demoContribRate">Avg Contribution Rate (%)</label>
                    <input type="number" id="demoContribRate" value="6" min="0" max="25" step="0.1" oninput="updateDemo()">
                </div>
                <div class="quick-input-group">
                    <label for="demoMatch">Employer Match (%)</label>
                    <input type="number" id="demoMatch" value="3" min="0" max="10" step="0.1" oninput="updateDemo()">
                </div>
                <div class="quick-input-group">
                    <label for="demoMatchUtil">Match Utilization (%)</label>
                    <input type="number" id="demoMatchUtil" value="75" min="0" max="100" oninput="updateDemo()">
                </div>
            </div>
        </div>

        <!-- Scenario Toggle -->
        <div class="demo-section">
            <h2>Engagement Scenarios</h2>
            <div class="scenario-toggle">
                <button class="scenario-btn active" onclick="setScenario('current')" data-scenario="current">Current Plan</button>
                <button class="scenario-btn" onclick="setScenario('auto-enroll')" data-scenario="auto-enroll">Auto-Enrollment</button>
                <button class="scenario-btn" onclick="setScenario('enhanced')" data-scenario="enhanced">Enhanced Engagement</button>
            </div>
        </div>

        <!-- Impact Metrics -->
        <div class="demo-section">
            <h2>Projected Impact</h2>
            <div class="impact-cards">
                <div class="impact-card">
                    <div class="impact-value" id="impactParticipants">325</div>
                    <div class="impact-label">Active Participants</div>
                    <div class="impact-change positive" id="participantChange">+65 new participants</div>
                </div>
                <div class="impact-card">
                    <div class="impact-value" id="impactContribution">$2.7M</div>
                    <div class="impact-label">Annual Contributions</div>
                    <div class="impact-change positive" id="contributionChange">+$750K annually</div>
                </div>
                <div class="impact-card">
                    <div class="impact-value" id="impactMatch">$1.1M</div>
                    <div class="impact-label">Employer Match</div>
                    <div class="impact-change positive" id="matchChange">+$300K utilized</div>
                </div>
                <div class="impact-card">
                    <div class="impact-value" id="impactReadiness">78</div>
                    <div class="impact-label">Readiness Score</div>
                    <div class="impact-change positive" id="readinessChange">+23 points</div>
                </div>
            </div>
        </div>

        <!-- Visualization -->
        <div class="demo-section">
            <h2>5-Year Engagement Projection</h2>
            <div class="demo-chart">
                <canvas id="demoChart"></canvas>
            </div>
        </div>

        <!-- Calculation Notes -->
        <div class="demo-section">
            <div class="calculation-notes">
                <h3>Methodology Notes:</h3>
                <ul>
                    <li><strong>Auto-Enrollment:</strong> Research shows auto-enrollment can increase participation from 65% to 90%+ and improve match utilization by 40-60%</li>
                    <li><strong>Enhanced Engagement:</strong> Combines auto-enrollment with auto-escalation, targeted education, and simplified investment menus</li>
                    <li><strong>Readiness Score:</strong> Weighted composite of participation rate (40%), contribution adequacy (35%), and match utilization (25%)</li>
                    <li><strong>Assumptions:</strong> 7% annual returns, 2.5% salary growth, current age and tenure demographics</li>
                </ul>
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="demo-section" style="text-align: center;">
            <div class="action-buttons">
                <button class="btn-action btn-secondary" onclick="goBack()">← Back to Setup</button>
                <button class="btn-action btn-success" onclick="goToEngagement()">📊 Full Analysis</button>
                <button class="btn-action btn-primary" onclick="exportDemo()">📄 Export Demo</button>
            </div>
        </div>
    </div>

    <script>
        let currentScenario = 'current';
        let demoChart = null;

        document.addEventListener('DOMContentLoaded', function() {
            updateDemo();
        });

        function loadPreset(size) {
            const presets = {
                small: { employees: 100, participation: 55, salary: 65000, contrib: 5.5, match: 2.5, matchUtil: 65 },
                medium: { employees: 500, participation: 65, salary: 75000, contrib: 6.0, match: 3.0, matchUtil: 75 },
                large: { employees: 2000, participation: 75, salary: 85000, contrib: 7.5, match: 4.0, matchUtil: 85 }
            };
            
            const preset = presets[size];
            document.getElementById('demoEmployees').value = preset.employees;
            document.getElementById('demoParticipation').value = preset.participation;
            document.getElementById('demoSalary').value = preset.salary;
            document.getElementById('demoContribRate').value = preset.contrib;
            document.getElementById('demoMatch').value = preset.match;
            document.getElementById('demoMatchUtil').value = preset.matchUtil;
            
            updateDemo();
        }

        function setScenario(scenario) {
            currentScenario = scenario;
            document.querySelectorAll('.scenario-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-scenario="${scenario}"]`).classList.add('active');
            updateDemo();
        }

        function updateDemo() {
            const employees = parseInt(document.getElementById('demoEmployees').value) || 0;
            const currentParticipation = parseFloat(document.getElementById('demoParticipation').value) || 0;
            const avgSalary = parseFloat(document.getElementById('demoSalary').value) || 0;
            const contribRate = parseFloat(document.getElementById('demoContribRate').value) || 0;
            const matchRate = parseFloat(document.getElementById('demoMatch').value) || 0;
            const matchUtil = parseFloat(document.getElementById('demoMatchUtil').value) || 0;

            // Calculate scenarios
            const scenarios = calculateScenarios(employees, currentParticipation, avgSalary, contribRate, matchRate, matchUtil);
            
            // Update impact cards
            updateImpactCards(scenarios);
            
            // Update chart
            updateChart(scenarios);
        }

        function calculateScenarios(employees, participation, salary, contrib, match, matchUtil) {
            const currentParticipants = Math.round(employees * (participation / 100));
            
            const scenarios = {
                current: {
                    participation: participation,
                    participants: currentParticipants,
                    contributions: currentParticipants * salary * (contrib / 100),
                    matchDollars: currentParticipants * salary * (match / 100) * (matchUtil / 100),
                    readiness: calculateReadiness(participation, contrib, matchUtil)
                },
                'auto-enroll': {
                    participation: Math.min(95, participation * 1.4), // Auto-enrollment boost
                    participants: 0,
                    contributions: 0,
                    matchDollars: 0,
                    readiness: 0
                },
                enhanced: {
                    participation: Math.min(98, participation * 1.6), // Enhanced engagement
                    participants: 0,
                    contributions: 0,
                    matchDollars: 0,
                    readiness: 0
                }
            };

            // Calculate derived values for enhanced scenarios
            ['auto-enroll', 'enhanced'].forEach(scenarioKey => {
                const scenario = scenarios[scenarioKey];
                scenario.participants = Math.round(employees * (scenario.participation / 100));
                
                const enhancedContrib = scenarioKey === 'auto-enroll' ? Math.max(contrib, 3) * 1.1 : Math.max(contrib, 3) * 1.3;
                const enhancedMatchUtil = scenarioKey === 'auto-enroll' ? Math.min(100, matchUtil * 1.5) : Math.min(100, matchUtil * 1.7);
                
                scenario.contributions = scenario.participants * salary * (enhancedContrib / 100);
                scenario.matchDollars = scenario.participants * salary * (match / 100) * (enhancedMatchUtil / 100);
                scenario.readiness = calculateReadiness(scenario.participation, enhancedContrib, enhancedMatchUtil);
            });

            return scenarios;
        }

        function calculateReadiness(participation, contribution, matchUtil) {
            // Weighted readiness score
            const participationWeight = 0.4;
            const contributionWeight = 0.35;
            const matchWeight = 0.25;
            
            const participationScore = Math.min(100, participation);
            const contributionScore = Math.min(100, (contribution / 10) * 100);
            const matchScore = matchUtil;
            
            return Math.round(
                (participationScore * participationWeight) +
                (contributionScore * contributionWeight) +
                (matchScore * matchWeight)
            );
        }

        function updateImpactCards(scenarios) {
            const current = scenarios.current;
            const selected = scenarios[currentScenario];

            document.getElementById('impactParticipants').textContent = selected.participants.toLocaleString();
            document.getElementById('impactContribution').textContent = '$' + (selected.contributions / 1000000).toFixed(1) + 'M';
            document.getElementById('impactMatch').textContent = '$' + (selected.matchDollars / 1000000).toFixed(1) + 'M';
            document.getElementById('impactReadiness').textContent = selected.readiness;

            // Update change indicators
            updateChangeIndicator('participantChange', selected.participants - current.participants, ' new participants');
            updateChangeIndicator('contributionChange', (selected.contributions - current.contributions) / 1000, 'K annually', '$');
            updateChangeIndicator('matchChange', (selected.matchDollars - current.matchDollars) / 1000, 'K utilized', '$');
            updateChangeIndicator('readinessChange', selected.readiness - current.readiness, ' points');
        }

        function updateChangeIndicator(elementId, change, suffix, prefix = '') {
            const element = document.getElementById(elementId);
            if (change > 0) {
                element.textContent = `+${prefix}${Math.abs(change).toFixed(0)}${suffix}`;
                element.className = 'impact-change positive';
            } else if (change < 0) {
                element.textContent = `-${prefix}${Math.abs(change).toFixed(0)}${suffix}`;
                element.className = 'impact-change negative';
            } else {
                element.textContent = 'No change';
                element.className = 'impact-change';
            }
        }

        function updateChart(scenarios) {
            const ctx = document.getElementById('demoChart').getContext('2d');
            
            if (demoChart) {
                demoChart.destroy();
            }

            // Create 5-year projection data
            const years = [0, 1, 2, 3, 4, 5];
            const chartData = {
                current: years.map(year => scenarios.current.readiness + (year * 1)), // Slow improvement
                'auto-enroll': years.map(year => {
                    const start = scenarios.current.readiness;
                    const end = scenarios['auto-enroll'].readiness;
                    return start + ((end - start) * (year / 5)) + (year * 2); // Faster improvement
                }),
                enhanced: years.map(year => {
                    const start = scenarios.current.readiness;
                    const end = scenarios.enhanced.readiness;
                    return start + ((end - start) * (year / 5)) + (year * 3); // Fastest improvement
                })
            };

            demoChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: years.map(y => `Year ${y}`),
                    datasets: [
                        {
                            label: 'Current Plan',
                            data: chartData.current,
                            borderColor: '#6c757d',
                            backgroundColor: 'rgba(108, 117, 125, 0.1)',
                            borderWidth: 3,
                            tension: 0.4
                        },
                        {
                            label: 'Auto-Enrollment',
                            data: chartData['auto-enroll'],
                            borderColor: '#667eea',
                            backgroundColor: 'rgba(102, 126, 234, 0.1)',
                            borderWidth: 3,
                            tension: 0.4
                        },
                        {
                            label: 'Enhanced Engagement',
                            data: chartData.enhanced,
                            borderColor: '#27ae60',
                            backgroundColor: 'rgba(39, 174, 96, 0.1)',
                            borderWidth: 3,
                            tension: 0.4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Retirement Readiness Score Progression'
                        },
                        legend: {
                            position: 'top'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            min: 30,
                            max: 100,
                            title: {
                                display: true,
                                text: 'Readiness Score'
                            }
                        }
                    }
                }
            });
        }

        function goBack() {
            window.location.href = 'index.html';
        }

        function goToEngagement() {
            window.location.href = 'engagement.html';
        }

        function exportDemo() {
            const demoData = {
                employees: document.getElementById('demoEmployees').value,
                participation: document.getElementById('demoParticipation').value,
                salary: document.getElementById('demoSalary').value,
                contribution: document.getElementById('demoContribRate').value,
                match: document.getElementById('demoMatch').value,
                matchUtilization: document.getElementById('demoMatchUtil').value,
                scenario: currentScenario,
                generatedDate: new Date().toISOString()
            };
            
            const dataStr = JSON.stringify(demoData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `engagement-demo-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
        }
    </script>
</body>
</html>